
<ion-view ng-controller="CampaignController">
  <ion-header-bar><a href="#/calendar/campaigns" class="button">
      <svg class="svg_icon svg_nav_icon">
        <use xlink:href="#richeng"></use>
      </svg></a>
    <h1 ng-click="showFilter($event)" class="title"><span>{{typeTitle}}&nbsp;</span><i class="icon ion-arrow-down-b"></i></h1><a ng-if="showSponsorButton" href="#/campaign/sponsor/campaigns" class="button icon ion-plus"></a>
  </ion-header-bar>
  <ion-content delegate-handle="mainScroll" overflow-scroll="true" class="campaigns_container">
    <ion-scroll class="campaign_list">
      <ion-refresher on-refresh="doRefresh()" refreshing-icon="ion-looping" pulling-text="下拉刷新" refreshing-text="刷新中..."></ion-refresher>
        <div ng-if="nowType=='all'||nowType=='newCampaigns'" class="campaign_container cp_unjoin">
          <div ng-if="newCampaigns.length&gt;0 || nowType=='newCampaigns'" ng-cloak="ng-cloak" class="campaign_container_title"><span>未参加的新活动 {{newCampaigns.length}}</span></div>
          <new-campaign-card ng-repeat="campaign in newCampaigns" campaign="campaign" campaign-index="$index" campaign-filter="newCampaigns" is-last="$index===newCampaigns.length-1"></new-campaign-card>
        </div>
        <div ng-if="nowType=='all'||nowType=='nowCampaigns'" class="campaign_container cp_now">
          <div ng-if="nowCampaigns.length&gt;0 || nowType=='nowCampaigns'" ng-cloak="ng-cloak" class="campaign_container_title"><span>进行中的活动 {{nowCampaigns.length}}</span></div>
          <new-campaign-card ng-repeat="campaign in nowCampaigns" campaign="campaign" campaign-index="$index" campaign-filter="nowCampaigns" is-last="$index===nowCampaigns.length-1"></new-campaign-card>
        </div>
        <div ng-if="nowType=='all'||nowType=='unStartCampaigns'" class="campaign_container cp_unstart">
          <div ng-if="unStartCampaigns.length&gt;0 || nowType=='unStartCampaigns'" ng-cloak="ng-cloak" class="campaign_container_title"><span>即将开始的活动 {{unStartCampaigns.length}}</span></div>
          <new-campaign-card ng-repeat="campaign in unStartCampaigns" campaign="campaign" campaign-index="$index" campaign-filter="unStartCampaigns" is-last="$index===unStartCampaigns.length-1"></new-campaign-card>
        </div>
      <div ng-if="noCampaigns" ng-cloak="ng-cloak" class="no_campaign">
        <div class="no_campaign_tip">
          <p>没有活动怎么办?</p>
          <p><a href="#/discover/teams/" class="team_link">发现</a><span class="tip_info">加入更多小队！</span></p>
        </div>
      </div>
    </ion-scroll>
  </ion-content>
</ion-view>
<script id="my-popover.html" type="text/ng-template">
  <ion-popover-view class="dl_popover campaign_filter_popover">
    <ion-content class="dl_popover_content">
      <button ng-click="filter('all')" class="dl_popover_button">所有活动</button>
      <button ng-click="filter('newCampaigns')" class="dl_popover_button">新活动</button>
      <button ng-click="filter('unStartCampaigns')" class="dl_popover_button">即将开始的活动</button>
      <button ng-click="filter('nowCampaigns')" ng-class="{'icon_blue':nowType=='nowCampaigns'}" class="dl_popover_button">正在进行的活动</button>
    </ion-content>
  </ion-popover-view>
</script>