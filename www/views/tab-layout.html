
<ion-tabs ng-controller="TabController" ng-class="{'tabs-item-hide': hideTabs}" class="tabs-icon-top app_tabs">
  <ion-tab title="活动" icon-on="ion_campaign_active" icon-off="ion_campaign" href="#/app/campaigns"><!-- Tab 1 content -->
    <ion-view ng-controller="CampaignController">
      <ion-header-bar><a href="#/calendar/campaigns" class="button icon ion-calendar"></a>
        <h1 class="title">活动</h1><a ng-if="showSponsorButton" href="#/campaign/sponsor/campaigns" class="button icon ion-plus"></a>
      </ion-header-bar>
      <ion-content delegate-handle="mainScroll" overflow-scroll="true" class="campaigns_container has-header">
        <div class="button-bar campaign_filter"><a ng-click="filter('all')" ng-class="{'icon_blue':nowType=='all'}" class="button button-clear">所有</a><a ng-click="filter('newCampaigns')" ng-class="{'icon_blue':nowType=='newCampaigns'}" class="button button-clear">新活动</a><a ng-click="filter('provokes')" ng-class="{'icon_blue':nowType=='provokes'}" class="button button-clear">挑战</a><a ng-click="filter('nowCampaigns')" ng-class="{'icon_blue':nowType=='nowCampaigns'}" class="button button-clear">进行中</a><a ng-click="filter('unStartCampaigns')" ng-class="{'icon_blue':nowType=='unStartCampaigns'}" class="button button-clear">即将</a></div>
        <ion-scroll class="campaign_list">
          <ion-refresher on-refresh="doRefresh()" refreshing-icon="ion-looping" pulling-text="下拉刷新" refreshing-text="刷新中..."></ion-refresher>
                <div ng-if="nowType=='all'||nowType=='newCampaigns'" class="campaign_container">
                  <div ng-if="newCampaigns.length&gt;0 || nowType=='newCampaigns'" ng-cloak="ng-cloak" class="campaign_container_title">
                    <p>未参加的新活动 {{newCampaigns.length}}</p>
                  </div>
                  <campaign-card ng-repeat="campaign in newCampaigns" campaign="campaign" campaign-index="$index" campaign-filter="newCampaigns"></campaign-card>
                </div>
                <div ng-if="nowType=='all'||nowType=='provokes'" class="campaign_container">
                  <div ng-if="provokes.length&gt;0 || nowType=='provokes'" ng-cloak="ng-cloak" class="campaign_container_title">
                    <p>挑战 {{provokes.length}}</p>
                  </div>
                  <campaign-card ng-repeat="campaign in provokes" campaign="campaign" campaign-index="$index" campaign-filter="provokes"></campaign-card>
                </div>
                <div ng-if="nowType=='all'||nowType=='nowCampaigns'" class="campaign_container">
                  <div ng-if="nowCampaigns.length&gt;0 || nowType=='nowCampaigns'" ng-cloak="ng-cloak" class="campaign_container_title">
                    <p>进行中的活动 {{nowCampaigns.length}}</p>
                  </div>
                  <campaign-card ng-repeat="campaign in nowCampaigns" campaign="campaign" campaign-index="$index" campaign-filter="nowCampaigns"></campaign-card>
                </div>
                <div ng-if="nowType=='all'||nowType=='unStartCampaigns'" class="campaign_container">
                  <div ng-if="unStartCampaigns.length&gt;0 || nowType=='unStartCampaigns'" ng-cloak="ng-cloak" class="campaign_container_title">
                    <p>即将开始的活动 {{unStartCampaigns.length}}</p>
                  </div>
                  <campaign-card ng-repeat="campaign in unStartCampaigns" campaign="campaign" campaign-index="$index" campaign-filter="unStartCampaigns"></campaign-card>
                </div>
          <div ng-if="noCampaigns" ng-cloak="ng-cloak" class="no_campaign">
            <div class="no_campaign_tip">
              <p>没有活动怎么办?</p>
              <p><a href="#/discover/teams/" class="team_link">发现</a><span class="tip_info">加入更多小队！</span></p>
            </div>
          </div>
        </ion-scroll>
      </ion-content>
      <div tabindex="-1" role="dialog" aria-hidden="true" id="{{pswpId}}" pswp-photo-album="pswpPhotoAlbum" class="pswp">
        <div class="pswp__bg"></div>
        <div class="pswp__scroll-wrap">
          <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
          </div>
          <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
              <div class="pswp__counter"></div>
              <button title="关闭" class="pswp__button pswp__button--close"></button>
              <button title="放大/缩小" class="pswp__button pswp__button--zoom"></button>
              <button ng-if="pswpPhotoAlbum" ng-click="pswpPhotoAlbum.goToAlbum()" title="查看相册" class="pswp__button dl_button_to_album"><i class="icon ion-image"></i></button>
              <div class="pswp__preloader">
                <div class="pswp__preloader__icn">
                  <div class="pswp__preloader__cut">
                    <div class="pswp__preloader__donut"></div>
                  </div>
                </div>
              </div>
            </div>
            <button title="上一张" class="pswp__button pswp__button--arrow--left"></button>
            <button title="下一张" class="pswp__button pswp__button--arrow--right"></button>
            <div class="pswp__caption">
              <div class="pswp__caption__center"></div>
            </div>
          </div>
        </div>
      </div>
    </ion-view>
  </ion-tab>
  <ion-tab title="讨论" icon-on="ion_discuss_active" icon-off="ion_discuss" badge="hasNewComment" href="#/app/discuss/list"><!-- Tab 2 content -->
    <ion-view ng-controller="DiscussListController" class="discuss_list">
      <ion-header-bar><a href="#/calendar/discuss_list" class="button icon ion-calendar"></a>
        <h1 class="title">讨论列表</h1>
      </ion-header-bar>
      <ion-content>
        <ion-refresher on-refresh="refresh()" refreshing-icon="ion-looping" pulling-text="下拉刷新" refreshing-text="刷新中..."></ion-refresher>
        <ul class="list"><a ng-repeat="commentCampaign in commentCampaigns track by $index" ng-show="$index&lt;unjoinedIndex" ng-click="goDetail(commentCampaign._id, commentCampaign.theme, $index)" ng-cloak="ng-cloak" class="item item-avatar"><img ng-src="{{STATIC_URL + commentCampaign.logo + '/45/45'}}"/>
            <div ng-if="commentCampaign.unread" class="red_spot"></div>
            <h2>{{commentCampaign.theme}}</h2>
            <p><span ng-show="commentCampaign.unread">[{{commentCampaign.unread}}条新评论]</span><span ng-bind-html="commentCampaign.latestComment.content || '[图片]' | emoji | unsafe"> </span></p></a><a ng-if="latestUnjoinedCampaign" ng-href="#/discuss/list/unjoined" ng-click="" class="item item-avatar"><img src="img/icons/unjoined_discuss.png" class="unjoined"/>
            <div ng-if="newUnjoined" class="red_spot"></div>
            <h2>其它小队讨论</h2>
            <p><span>{{latestUnjoinedCampaign.theme}}</span></p></a><a ng-repeat="commentCampaign in commentCampaigns track by $index" ng-show="$index&gt;=unjoinedIndex" ng-click="goDetail(commentCampaign._id, commentCampaign.theme, $index)" ng-cloak="ng-cloak" class="item item-avatar"><img ng-src="{{STATIC_URL + commentCampaign.logo + '/45/45'}}"/>
            <div ng-if="commentCampaign.unread" class="red_spot"></div>
            <h2>{{commentCampaign.theme}}</h2>
            <p><span ng-show="commentCampaign.unread">[{{commentCampaign.unread}}条新评论]</span><span ng-bind-html="commentCampaign.latestComment.content || '[图片]' | emoji | unsafe"> </span></p></a></ul>
      </ion-content>
    </ion-view>
  </ion-tab>
  <ion-tab title="发现" icon-on="ion-help-buoy" icon-off="ion-help-buoy" href="#/app/discover"><!-- Tab 2 content -->
    <ion-view ng-controller="DiscoverController" class="discover">
      <ion-header-bar>
        <h1 class="title">发现</h1>
      </ion-header-bar>
      <ion-content>
        <div class="discover_image"></div>
        <div class="list"><a href="#/discover/search_opponent" class="item item-icon-left item-icon-right"><i class="icon ion_teams"></i>找对手<i class="icon ion-chevron-right"></i></a><a href="#/rank/select" class="item item-icon-left item-icon-right"><i class="icon ion-android-contacts"></i>排行榜<i class="icon ion-chevron-right"></i></a><a href="#/competition_message/list" class="item item-icon-left item-icon-right"><i class="icon ion_ballon"></i>挑战日志<i class="icon ion-chevron-right"></i></a></div>
        <div class="rank_panel">
          <div class="team_select">
            <label class="item item-input item-select"><span class="input-label">我的小队排名:</span>
              <select ng-change="changeSelectTeam(selectTeam)" ng-model="selectTeam" ng-options="team.name for team in teams" class="select_info"></select>
            </label>
          </div>
          <div class="rank_table">
            <div ng-repeat="rankTeam in selectTeam.rankTeams" class="row">
              <div class="col">{{rankTeam.score_rank.rank}}</div>
              <div class="col"><img ng-src="{{STATIC_URL + rankTeam.logo}}/40/40" class="team_logo"/></div>
              <div class="col">{{rankTeam.name}}</div>
              <div class="col">{{rankTeam.score_rank.score || 0}}</div>
              <div class="col">{{rankTeam.score_rank.winPercent}}</div>
            </div>
          </div>
        </div>
      </ion-content>
    </ion-view>
  </ion-tab>
  <ion-tab title="公司" icon-on="ion_company_active" icon-off="ion_company" href="#/app/company"><!-- Tab 3 content -->
    <ion-view ng-controller="CompanyController" class="company">
      <ion-header-bar>
        <h1 class="title">公司</h1>
      </ion-header-bar>
      <ion-content>
        <div class="company_image"></div>
        <div class="list"><a href="#/company/teams/official" class="item item-icon-left item-icon-right"><i class="icon ion_teams"></i>所有小队<span class="item-note">{{teams.length}}</span><i class="icon ion-chevron-right"></i></a><a href="#/company/contacts" class="item item-icon-left item-icon-right"><i class="icon ion-android-contacts"></i>通讯录<i class="icon ion-chevron-right"></i></a><a href="#/company/circle" class="item item-icon-left item-icon-right"><i class="icon ion_ballon"></i>所有活动<i class="icon ion-chevron-right"></i></a>
        </div>
      </ion-content>
    </ion-view>
  </ion-tab>
  <ion-tab title="我的" icon-on="ion_personal_active" icon-off="ion_personal" href="#/app/personal">
    <ion-view ng-controller="PersonalController" class="personal">
      <ion-header-bar>
        <h1 class="title">我的</h1>
      </ion-header-bar>
      <ion-content>
        <div class="list"><a href="#/personal/edit" ng-cloak="ng-cloak" class="item item-avatar item-icon-right"><img ng-if="user" ng-src="{{STATIC_URL + user.photo}}/80/80" prevent-default="prevent-default" photo="user.photo" pswp-id="pswpId" open-photo="open-photo"/>
            <h2>{{user.nickname}}</h2>
            <p ng-if="user.introduce">简介: {{user.introduce}}</p><i class="icon ion-chevron-right"></i></a>
          <div ng-cloak="ng-cloak" class="item statistics">
            <div class="row"><a href="#/personal/teams/" class="col col-33">
                <p class="number">{{user.tids.length}}</p>
                <p class="key">小队</p></a><a href="#/personal/timeline" class="col col-33">
                <p class="number">{{user.campaignCount}}</p>
                <p class="key">活动</p></a>
              <div class="col col-33">
                <p class="number">{{user.score}}</p>
                <p class="key">积分</p>
              </div>
            </div>
          </div>
        </div>
        <div class="list"><a href="#/personal/teams/" class="item item-icon-left item-icon-right"><i class="icon ion_teams"></i>我的小队<span class="item-note">{{user.tids.length}}</span><i class="icon ion-chevron-right"></i></a><a href="#/personal/timeline" class="item item-icon-left item-icon-right"><i class="icon ion_foot"></i>我的足迹<i class="icon ion-chevron-right"></i></a><a href="#/calendar/personal" class="item item-icon-left item-icon-right"><i class="icon ion_calendar"></i>我的日程<i class="icon ion-chevron-right"></i></a><a href="#/personal/invitecode" class="item item-icon-left item-icon-right"><i class="icon ion_invite_code"></i>激活码<i class="icon ion-chevron-right"></i></a><a href="#/settings" class="item item-icon-left item-icon-right"><i class="icon ion_setting"></i>设置<i class="icon ion-chevron-right"></i></a>
        </div>
      </ion-content>
      <div tabindex="-1" role="dialog" aria-hidden="true" id="{{pswpId}}" class="pswp">
        <div class="pswp__bg"></div>
        <div class="pswp__scroll-wrap">
          <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
          </div>
          <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
              <div class="pswp__counter"></div>
              <button title="关闭" class="pswp__button pswp__button--close"></button>
              <button title="放大/缩小" class="pswp__button pswp__button--zoom"></button>
              <div class="pswp__preloader">
                <div class="pswp__preloader__icn">
                  <div class="pswp__preloader__cut">
                    <div class="pswp__preloader__donut"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="pswp__caption">
              <div class="pswp__caption__center"></div>
            </div>
          </div>
        </div>
      </div>
    </ion-view>
  </ion-tab>
</ion-tabs>