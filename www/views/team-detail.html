
<ion-view>
  <ion-header-bar><a ng-href="{{backUrl}}" class="button icon-left ion-chevron-left">&nbsp;返回</a>
    <h1 class="title">{{team.name}}</h1>
  </ion-header-bar>
  <ion-content class="team_page">
    <div class="team_header">
      <ion-slide-box ng-cloak="ng-cloak">
        <ion-slide ng-repeat="photo in team.familyPhotos"><img ng-src="{{STATIC_URL + photo.uri}}/640/380" class="team_family"/></ion-slide>
      </ion-slide-box><img ng-if="team.familyPhotos.length === 0" src="./img/family.png" class="team_family"/><img ng-if="team" ng-src="{{STATIC_URL + team.logo}}/130/130" class="logo"/><a ng-if="team.isLeader" ng-href="#/team/{{team._id}}/family" class="triangle_right_top"></a><a ng-if="team.isLeader" ng-href="#/team/{{team._id}}/family" class="triangle_left_bottom"></a>
    </div>
    <div class="card team_info">
      <div class="info_header clearfix">
        <div class="team_name">{{team.name}}</div>
        <div class="team_type">{{team.groupType}}</div>
      </div>
      <div class="info_body">
        <div class="start_time">成立时间: {{team.createTime | date:'yyyy-MM-dd'}}</div>
        <div ng-if="team.poster" class="team_des">创建人: {{team.poster.nickname}}</div>
        <div class="team_des">小队简介:<span ng-if="team.brief" ng-cloak="ng-cloak">{{team.brief}}</span><span ng-if="!team.brief" ng-cloak="ng-cloak">无</span></div>
        <button prevent-default="prevent-default" ng-if="team.hasJoined" ng-click="quitTeam(team._id)" class="btn_joined">已加入小队</button>
        <button prevent-default="prevent-default" ng-if="!team.hasJoined" ng-click="joinTeam(team._id)" class="btn_join">立即加入</button>
      </div>
      <div class="info_footer row"><a ng-href="#/photo_album/list/team/{{team._id}}" class="col btn_upload_photo">上传照片</a><a ng-href="#/members/team/{{team._id}}" class="col btn_member">{{team.memberCount}}名队员</a>
        <div class="col btn_cp">0个活动</div>
      </div>
    </div>
    <div class="card team_home_court">
      <div class="row home_court_tabs">
        <div ng-class="{'active': homeCourtIndex===0}" ng-click="selectHomeCourt(0)" class="col tab">主场一</div>
        <div ng-class="{'active': homeCourtIndex===1}" ng-click="selectHomeCourt(1)" class="col tab">主场二</div>
      </div>
      <div ng-repeat="homeCourt in homeCourts" ng-if="homeCourtIndex==$index" class="map">
        <div ng-if="!homeCourt.empty"><a ng-cloak="ng-cloak" ng-if="homeCourt.loc.coordinates.length===2" href="#" ng-click="linkMap(homeCourt)" class="map_wrap"><img ng-src="http://restapi.amap.com/v3/staticmap?location={{homeCourt.loc.coordinates[0]}},{{homeCourt.loc.coordinates[1]}}&amp;zoom=15&amp;size=300*130&amp;markers=mid,,A:{{homeCourt.loc.coordinates[0]}},{{homeCourt.loc.coordinates[1]}}&amp;labels={{homeCourt.name}},2,0,12,0xffffff,0x3498db:{{homeCourt.loc.coordinates[0]}},{{homeCourt.loc.coordinates[1]}}&amp;key=077eff0a89079f77e2893d6735c2f044" class="map_img"/></a>
          <p ng-cloak="ng-cloak" ng-if="homeCourt.name" class="home_court_name">{{homeCourt.name}}</p>
        </div>
        <div ng-if="homeCourt.empty"><img src="./img/no_homecourt.png" class="no_homecourt"/></div>
      </div>
    </div>
    <div class="card member_card">
      <ion-scroll direction="x" scrollbar-x="false">
        <div class="member_wrap"><img ng-repeat="leader in team.leaders" ng-src="{{STATIC_URL + leader.photo}}/45/45" class="member"/></div>
        <div class="member_wrap"><img ng-repeat="member in team.members" ng-src="{{STATIC_URL + member.photo}}/45/45" class="member"/></div>
      </ion-scroll><a ng-href="#/members/team/{{team._id}}" class="member_link"><span class="member_count">{{team.memberCount}}&nbsp;</span><i class="icon ion-chevron-right"></i></a>
    </div>
    <div ng-repeat="group in campaignGroups" class="dl_campaign_group">
      <p class="dl_campaign_group_date">{{group.date | date:'yyyy-MM'}}</p>
      <campaign-card ng-repeat="campaign in group.campaigns" campaign="campaign"></campaign-card>
    </div>
    <ion-infinite-scroll on-infinite="loadMore()" distance="1%" ng-if="moreDataCanBeLoaded()"></ion-infinite-scroll>
  </ion-content>
</ion-view>