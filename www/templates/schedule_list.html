<ion-view title="日程列表">
  <ion-nav-buttons side="left">
    <button menu-toggle="left" class="button button-icon icon ion-navicon"></button>
  </ion-nav-buttons>
  <ion-content class="has-header" scrollbar-y="false">

    <div class="calendar">
      <nav no-scroll>
        <div class="operator clearfix">
          <div class="pull-left">
            <div class="btn" ng-if="view==='month'" ng-click="back()"><i class="icon ion-chevron-left"></i>&nbsp;{{ current_year }}</div>
            <div class="btn" ng-if="view==='day'" ng-click="back()"><i class="icon ion-chevron-left"></i>&nbsp;{{ current_month.format_month }}</div>
          </div>
          <div class="pull-right" ng-if="view!=='year'">
            <div class="btn today" ng-click="today()">今天</div>
          </div>
        </div>
        <div class="week text-center clearfix" ng-if="view!=='year'">
          <div class="day weekend">日</div>
          <div class="day">一</div>
          <div class="day">二</div>
          <div class="day">三</div>
          <div class="day">四</div>
          <div class="day">五</div>
          <div class="day weekend">六</div>
        </div>
        <div class="date_list text-center clearfix" ng-if="view==='day'">
          <div class="date_box" ng-repeat="date in current_week_date">
            <div class="date" ng-class="{today: date.is_today===true, current_day: date.is_current===true}" ng-click="dayView(date)">{{ date.getDate() }}</div>
          </div>
        </div>
        <div class="date_bar text-center" ng-if="view==='day'">{{ current_day.format_date }}&nbsp;{{ current_day.format_day }}</div>
      </nav>
      <div class="calendar_box" ng-class="{full_box: view==='year'}">
        <div class="calendar_year clearfix" ng-if="view==='year'" no-scroll>
          <div class="year_section" ng-repeat="month in year" ng-click="monthView($index)">
            <div class="table_wrap">
              <div class="table_cell">
                <div class="year_box">{{ month }}</div>
              </div>
            </div>
          </div>
        </div>
        <div class="calendar_month clearfix" ng-if="view==='month'" no-scroll>
          <swipe-cards>
            <swipe-card class="clearfix" ng-repeat="month in month_cards" on-up="nextMonth(month)" on-down="preMonth(month)" on-destroy="removeMonth($index)">
              <div class="month" ng-class="month.offset">{{ month.format_month }}</div>
              <div class="calendar_day text-center" ng-repeat="day in month.days" ng-class="day.first_day">
                <div class="calendar_date" ng-class="{weekend: day.is_weekend===true, today: day.is_today===true}" ng-click="dayView(day.full_date)">{{ day.date }}</div>
                <div class="event_unjoin" ng-if="day.has_event && !day.has_joined_event"></div>
                <div class="event_joined" ng-if="day.has_joined_event"></div>
              </div>
            </swipe-card>
          </swipe-cards>
        </div>
        <div class="calendar_day clearfix" ng-if="view==='day'" auto-height sub-height="121">
          <swipe-cards>
            <ion-scroll scrollbar-y="false">
              <swipe-card class="clearfix" ng-repeat="day in day_cards" on-left="nextDay(day)" on-right="preDay(day)" on-destroy="removeDay($index)">
                <a class="calendar_campaign" ng-repeat="campaign in day.campaigns" ng-href="#/app/campaign_detail/{{ campaign._id }}/">
                  <div class="logo"><img ng-src="{{base_url +  campaign.logo }}"/></div>
                  <div class="calendar_content">
                    <div class="text">{{ campaign.theme }}</div>
                    <div class="text time">开始: {{ campaign.format_start_time }}</div>
                    <div class="text time">结束: {{ campaign.format_end_time }}</div>
                    <div class="joined_flag" ng-if="campaign.is_joined">已参加</div>
                  </div>
                </a>
                <div class="text-center" ng-if="day.campaigns.length === 0">今天没有活动哦</div>
              </swipe-card>
            </ion-scroll>
          </swipe-cards>
        </div>
      </div>
    </div>
  </ion-content>
</ion-view>
