ion-view.discuss_detail(cache-view="false" title="{{campaignTitle}}")
  ion-header-bar
    a.button.icon-left.ion-chevron-left(ng-click="goBack()") &nbsp;返回
    h1.title(ng-cloak) {{campaignTitle}}
    a.button.icon-right.ion_campaign_active(href="#/campaign/detail/{{campaignId}}")

  ion-content
    //- ion-refresher(on-refresh="refresh()" refreshing-icon="ion-looping" pulling-text="下拉读取历史记录" refreshing-text="读取中...")
    .comments(ng-click="hideEmotions()")
      .blocks
        .block(ng-repeat="comment in comments track by $index" ng-init="showTime=needShowTime($index,comments)" ng-cloack)
          .time_block(ng-show="showTime && ($index!==0||($index===0))")
            p
              span.time(ng-show="showTime===1 && ($index!==0||($index===0))" ng-cloak) {{comment.create_date | date: 'yyyy'}}
            p
              span.time(ng-cloak) {{comment.create_date | date: 'M月dd日 HH:mm'}}
          .comment.clearfix(ng-class="{putright: comment.poster._id == userId}" ng-if="comment.content" ng-cloak)
            a.logo(ng-href="#/user/{{comment.poster._id}}")
              img(ng-src="{{STATIC_URL +comment.poster.photo+ '/45/45'}}")
            .contents
              .name(ng-if="comment.poster._id !== userId" ng-cloak) {{comment.poster.nickname}}
              .name(ng-if="comment.poster._id == userId" ng-cloak) 我
              .content
                .triangle_isosceles(ng-bind-html="comment.content | emoji | unsafe")
          .failed(ng-if="comment.failed" ng-cloak)
            .tip
              i.icon.ion-alert-circled
              span 发送失败

    ion-infinite-scroll(ng-if="!loading&&hasMore" icon="ion-looping" on-infinite="readHistory()" distance="-2%")
  ion-footer-bar.comment_box
    publish-box(is-show-emotions="isShowEmotions" is-writing="isWriting" content="content" publish="publish()" )
