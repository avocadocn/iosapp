ion-view.dl_campaign_detail
  ion-header-bar
    a.button.icon-left.ion-chevron-left(ng-click="goBack()") &nbsp;返回
    h1.title(ng-cloak) {{campaign.theme + (!campaign || campaign.active ? '' : '(已关闭)')}}
    a.button.dl_cp_edit(ng-if="campaign.active && campaign.allow.editTeamCampaign || campaign.allow.editCompanyCampaign" href="#/campaign/edit/{{campaign._id}}") 编辑
  ion-content(delegate-handle="detailScroll")
    .campaign_detail(ng-cloak)
      .campaign_info
        .cp_logos(class="logos_{{campaign.campaign_unit.length}}")
          a(ng-href="{{campaign.campaign_unit[0].team._id ? '#/team/'+ campaign.campaign_unit[0].team._id: ''}}")
            img.team_logo(ng-repeat="campaign_unit in campaign.campaign_unit" ng-src="{{STATIC_URL + (campaign_unit.team.logo || campaign_unit.company.logo)}}/60/60")
          .provoke_label(ng-if="campaign.campaign_type===4 || campaign.campaign_type===5")
            span 挑战
          .fellowship_label(ng-if="campaign.campaign_type===7")
            span 联谊 
          a(ng-href="{{campaign.campaign_unit[0].team._id ? '#/team/'+ campaign.campaign_unit[0].team._id: ''}}")
        .team_name(ng-bind="campaign.campaign_unit[0].team.name || campaign.campaign_unit[0].company.name")
        .cp_time
          i.icon.icon_small.ion_time
          span(ng-cloak) {{campaign.start_time | date:"MM-dd HH:mm"}} ~~ {{campaign.end_time | date:"MM-dd  HH:mm" }}
        .cp_member(ng-if="campaign.is_start"  ng-cloak)
          i.icon.icon_small.ion_member
          span.member_num {{campaign.members_count}}
          span.member_num {{campaign.member_max!=0 ? ' | ' + campaign.member_max :''}}
        .cp_address(ng-if="!campaign.is_start" ng-cloak)
          i.icon.icon_small.ion_address
          span.cp_location {{campaign.location.name}}
      //- 测试用
      .item.item-text-wrap
        button.button.button-small.button-positive(ng-click="chooseUploadImages()") 发同事圈
      a.item.item_header.cp_address(ng-if="campaign.is_start || campaign.allow.quitCampaign" ng-href="#/location/{{campaign._id}}" ng-cloak)
        span.cp_location_title 活动地点:
        span.cp_location {{campaign.location.name}}
        span.icon.icon_small.ion-chevron-right.button-clear
      .item.campaign_footer(ng-if="campaign && !campaign.is_start && !campaign.allow.quitCampaign" ng-cloak)
        a.footer_col(ng-href="#/members/campaign/{{campaign._id}}")
          i.ion_member.dl_icon.icon_small
          span.member_num {{campaign.members_count}}
          span.member_split(ng-if="campaign.member_max!=0") |
          span.member_num(ng-if="campaign.member_max!=0") {{campaign.member_max}}
        .footer_col(ng-click="goDiscussDetail(campaign._id, campaign.theme)")
          i.dl_icon.ion_chat_circle
          span 讨论
      a.item.item_header(ng-href="#/campaign/notice/{{campaign._id}}")
        span 活动公告
        span.icon.icon_small.ion-chevron-right.button-clear
      .item.item-text-wrap(ng-if="campaign && !campaign.is_start && !campaign.allow.quitCampaign")
        span.dl_card_title 活动详情:
        p {{campaign.content ?campaign.content :'暂无'}}
      a.item.item_header(ng-if="campaign.is_start || campaign.allow.quitCampaign" ng-href="#/campaign/content/{{campaign._id}}")
        span 活动详情
        span.icon.icon_small.ion-chevron-right.button-clear
      .item.campaign_footer(ng-if="!campaign.is_start && campaign.allow.quitCampaign")
        .footer_col(ng-click="goDiscussDetail(campaign._id, campaign.theme)")
          i.dl_icon.ion_chat_circle
          span 讨论
        .footer_col(ng-click="quit(campaign._id)")
          i.dl_icon.ion_log_out
          span 退出
      a.item.item_header(ng-if="campaign.is_start" ng-click="goDiscussDetail(campaign._id, campaign.theme)")
        span 讨论
        span.icon.icon_small.ion-chevron-right.button-clear
      .item.item-divider 精彩瞬间
      circle-card-list(circle-list="circleContentList" user="user" ctrl="circleCardListCtrl" on-click-comment-button="openCommentBox" on-click-content-img="onClickContentImg" static-url="STATIC_URL")
      ion-infinite-scroll(ng-if="loadingStatus.hasMore && loadingStatus.hasInit" icon="ion-looping" on-infinite="loadMore()" distance="1%")
  //- 与ion-content同级
  circle-comment-box(ctrl="circleCommentBoxCtrl" on-post="postComment" on-stop="stopComment")
  photo-swipe(photos="imagesForPswp" ctrl="pswpCtrl")
  ion-footer-bar(ng-if="campaign.allow.joinTeamCampaign || campaign.allow.joinCompanyCampaign")
    button.button.button-full.dl_cp_join(ng-if="campaign.allow.joinTeamCampaign || campaign.allow.joinCompanyCampaign"  ng-click="join(campaign._id)") 报名参加