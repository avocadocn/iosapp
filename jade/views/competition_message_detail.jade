ion-view.competition_message_panel
  ion-header-bar
    a.button.icon.ion-chevron-left(ng-click="goBack()") &nbsp;返回
    h1.title 挑战日志
    a.button.button-clear.button-positive(ng-if="sponsorLeader && competitionMessage.status=='accepted'" ng-click="sponsorCompetition()") 发活动
  ion-content
    .competition_message_detail(ng-if="competitionMessage")
      .row
        .col {{competitionMessage.create_time | beforeNow}}
        .col: img.team_logo(ng-src="{{STATIC_URL + competitionMessage.sponsor_team.logo}}/40/40")
        .col {{competitionMessage.sponsor_team.name}}
        .col VS
        .col: img.team_logo(ng-src="{{STATIC_URL + competitionMessage.opposite_team.logo}}/40/40")
        .col {{competitionMessage.opposite_team.name}}
      .row
        .col(ng-cloak) 活动性质：{{competitionMessage.competition_type==1 ? '挑战' :'联谊'}}
      .row
        .col(ng-cloak) 状态：{{competitionMessage.status | competitionMessageStatusFormat}}
      .row(ng-if="oppositeLeader && competitionMessage.status=='sent'")
        .button-bar
          button.button.button-positive(ng-click="dealCompetition('accept')") 应战
          button.button.button-assertive(ng-click="dealCompetition('reject')") 拒绝
      .row.teams
        .col.team.sponsor_team 挑战方
        .col.col-10.vs VS
        .col.team.opposite_team 应战方
      .vote
        .vote_team(ng-repeat="unit in competitionMessage.vote.units" ng-style="{'width':unit.percent+'%'}" ng-click="voteCompetition($index)")
          .vote_icon
            i.icon.ion-ios7-heart-outline
          span.vote_num {{unit.positive}} 人支持
    .competition_message_comment(ng-if="competitionMessage")
      .row
        .col
          img.member_logo(ng-src="{{STATIC_URL + competitionMessage.sponsor_team.logo}}/40/40")
        .col(ng-bind-html="competitionMessage.content | emoji | unsafe")
        .col {{competitionMessage.create_time | date:"MM-dd HH:mm"}}
      .row(ng-repeat="comment in commentList ")
        .col(ng-if="comment.poster._id!==userId")
          img.member_logo(ng-src="{{STATIC_URL + comment.poster.photo}}/40/40")
          p {{comment.poster.nickname}}
        .col(ng-if="comment.poster._id===userId") {{comment.create_date | date:"MM-dd HH:mm"}}
        .col(ng-bind-html="comment.content | emoji | unsafe")
        .col(ng-if="comment.poster._id!==userId") {{comment.create_date | date:"MM-dd HH:mm"}}
        .col(ng-if="comment.poster._id===userId")
          img.member_logo(ng-src="{{STATIC_URL + comment.poster.photo}}/40/40")
          p {{comment.poster.nickname}}
    //- ion-infinite-scroll(ng-if="canloadMore()" on-infinite="getCompetitionComments(1)" distance="-10%")
  ion-footer-bar.comment_box(ng-show="oppositeLeader || sponsorLeader")
    publish-box(is-show-img='false' is-show-emotions="isShowEmotions" is-writing="isWriting" content="content" publish="publishComment()")



